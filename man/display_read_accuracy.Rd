% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/display_read_accuracy.R
\name{display_read_accuracy}
\alias{display_read_accuracy}
\title{Display Nanopore Read Accuracy}
\usage{
display_read_accuracy(
  fastq,
  output_dir = NULL,
  threads = 2,
  output_format = "plot",
  table_format = "kable",
  theme = "sandstone"
)
}
\arguments{
\item{fastq}{Character string. Path to the input FASTQ file.}

\item{output_dir}{Character string or NULL. Directory to save output files.
If NULL (default), no files are saved to disk.}

\item{threads}{Integer. Number of threads to use for alignment.
Default is 2}

\item{output_format}{Character string. Format for output: "plot" (default), "table", or "both".
"plot" returns a ggplot2 histogram, "table" returns a summary statistics table,
"both" returns a list with both elements.}

\item{table_format}{Character string. Format for table output: "kable" (default) or "data.frame".
Only used when output_format is "table" or "both".}

\item{theme}{Character string. Theme for plot and table styling: "sandstone" (default), "simplex", "flatly",
"journal", "lumen", "spacelab", "united".
The theme affects both the plot colors (histogram fill, lines, text) and table appearance.}
}
\value{
Depends on output_format:
\itemize{
\item "plot": A ggplot2 object showing the distribution of read accuracies
\item "table": An HTML table (browsable) or data.frame with summary statistics
\item "both": A list with $plot and $table elements
\item NULL if no aligned reads are found
}
}
\description{
Analyzes basecalled FASTQ files from Oxford Nanopore sequencers to calculate and visualize
read accuracy distributions by aligning reads to a DNA CS standard reference sequence.
Results can be displayed as plots, tables, or both with unified professional themes.
}
\details{
This function performs the following steps:
\enumerate{
\item Creates a temporary reference sequence (DNA CS standard)
\item Aligns FASTQ reads using minimap2
\item Calculates per-read accuracy based on alignment length and edit distance
\item Creates output based on specified format (histogram and/or table)
}

Accuracy is calculated as: (alignment_length - edit_distance) / alignment_length
where alignment_length is derived from the CIGAR string and edit_distance is from
the NM tag. This method correctly accounts for substitutions, insertions, and deletions.

The function requires external tools minimap2 and samtools to be installed
and available in the system PATH.

When output_format includes "table", the following statistics are provided:
mean, median, standard deviation, min, max, and various percentiles (5th, 25th, 75th, 95th).

The theme parameter creates visual consistency between plots and tables, with three
professional options inspired by Quarto themes.
}
\examples{
\dontrun{
# Basic usage - returns ggplot object
p <- display_read_accuracy("sample.fastq")
print(p)

# Get summary table only
table <- display_read_accuracy("sample.fastq", output_format = "table")
print(table)

# Get both plot and table with matching flatly theme
results <- display_read_accuracy("sample.fastq",
                                 output_format = "both",
                                 theme = "flatly")
print(results$plot)
print(results$table)

# Get data.frame for programmatic use
df <- display_read_accuracy("sample.fastq",
                            output_format = "table",
                            table_format = "data.frame")

# Save results to directory with simplex theme
display_read_accuracy("sample.fastq",
                     output_dir = "./results/",
                     output_format = "both",
                     theme = "simplex")

# Use in Quarto/R Markdown with matching theme
# In chunk with results='asis':
results <- display_read_accuracy("sample.fastq",
                                output_format = "both",
                                theme = "sandstone")
}

}
\seealso{
\code{\link{plot_read_accuracy}} (deprecated, use this function instead)
}
